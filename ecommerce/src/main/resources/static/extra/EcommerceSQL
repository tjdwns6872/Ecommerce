#회원 테이블
CREATE TABLE EC_USERS (
  EC_USERS_USER_ID NUMBER(10) PRIMARY KEY,
  EC_USERS_EMAIL VARCHAR2(100),
  EC_USERS_PASSWORD_HASH VARCHAR2(64),
  EC_USERS_NAME VARCHAR2(50) NOT NULL,
  EC_USERS_PHONE_NUMBER VARCHAR2(20),
  EC_USERS_PROFILE_IMAGE_URL VARCHAR2(255),
  EC_USERS_BIRTH_DATE DATE,
  EC_USERS_USER_TYPE VARCHAR2(10) CHECK (EC_USERS_USER_TYPE IN ('BUYER', 'SELLER', 'ADMIN')),
  EC_USERS_IS_SOCIAL_LOGIN NUMBER(1) DEFAULT 0,
  EC_USERS_REFERRAL_CODE VARCHAR2(20) UNIQUE,
  EC_USERS_CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
  EC_USERS_UPDATED_AT TIMESTAMP
);

CREATE SEQUENCE EC_USERS_SEQ START WITH 1 INCREMENT BY 1;

COMMENT ON COLUMN EC_USERS.EC_USERS_USER_ID IS '사용자 고유 식별자';
COMMENT ON COLUMN EC_USERS.EC_USERS_EMAIL IS '사용자 이메일 주소 (Nullable)';
COMMENT ON COLUMN EC_USERS.EC_USERS_PASSWORD_HASH IS '암호화된 비밀번호 (소셜 로그인 사용자는 NULL 가능)';
COMMENT ON COLUMN EC_USERS.EC_USERS_NAME IS '사용자 이름';
COMMENT ON COLUMN EC_USERS.EC_USERS_PHONE_NUMBER IS '전화번호';
COMMENT ON COLUMN EC_USERS.EC_USERS_PROFILE_IMAGE_URL IS '프로필 이미지 URL';
COMMENT ON COLUMN EC_USERS.EC_USERS_BIRTH_DATE IS '생년월일';
COMMENT ON COLUMN EC_USERS.EC_USERS_USER_TYPE IS '사용자 유형 (구매자/판매자/관리자)';
COMMENT ON COLUMN EC_USERS.EC_USERS_IS_SOCIAL_LOGIN IS '소셜 로그인 사용자 여부';
COMMENT ON COLUMN EC_USERS.EC_USERS_REFERRAL_CODE IS '추천인 코드';
COMMENT ON COLUMN EC_USERS.EC_USERS_CREATED_AT IS '계정 생성 일시';
COMMENT ON COLUMN EC_USERS.EC_USERS_UPDATED_AT IS '계정 정보 수정 일시';

#소셜 로그인 관련 테이블
CREATE TABLE EC_SOCIAL_ACCOUNTS (
  EC_SOCIAL_ID NUMBER(10) PRIMARY KEY,
  EC_SOCIAL_USER_ID NUMBER(10) NOT NULL,
  EC_SOCIAL_PROVIDER VARCHAR2(20) CHECK (EC_SOCIAL_PROVIDER IN ('KAKAO', 'NAVER', 'GOOGLE')),
  EC_SOCIAL_SOCIAL_ID VARCHAR2(100) NOT NULL,
  EC_SOCIAL_SOCIAL_EMAIL VARCHAR2(100),
  EC_SOCIAL_SOCIAL_NAME VARCHAR2(50),
  EC_SOCIAL_LAST_LOGIN_AT TIMESTAMP,
  EC_SOCIAL_CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
  EC_SOCIAL_UPDATED_AT TIMESTAMP,
  CONSTRAINT FK_EC_SOCIAL_USER FOREIGN KEY (EC_SOCIAL_USER_ID) REFERENCES EC_USERS(EC_USERS_USER_ID),
  CONSTRAINT UQ_EC_SOCIAL_ACCOUNT UNIQUE (EC_SOCIAL_PROVIDER, EC_SOCIAL_SOCIAL_ID)
);

CREATE SEQUENCE EC_SOCIAL_ACCOUNTS_SEQ START WITH 1 INCREMENT BY 1;

COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_ID IS '소셜 계정 고유 식별자';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_USER_ID IS '연결된 사용자 ID';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_PROVIDER IS '소셜 로그인 제공자';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_SOCIAL_ID IS '소셜 플랫폼 고유 식별자';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_SOCIAL_EMAIL IS '소셜 계정 이메일 (제공되는 경우)';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_SOCIAL_NAME IS '소셜 계정 이름';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_LAST_LOGIN_AT IS '마지막 소셜 로그인 시간';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_CREATED_AT IS '소셜 계정 연동 일시';
COMMENT ON COLUMN EC_SOCIAL_ACCOUNTS.EC_SOCIAL_UPDATED_AT IS '소셜 계정 정보 수정 일시';